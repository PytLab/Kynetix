from operator import mul

import numpy as np
import matplotlib.pyplot as plt

from kynetix.functions import convert_time


def plot_scatters(types,
                  shape,
                  coordinates,
                  markers,
                  possible_types,
                  color_dict,
                  time, step,
                  circle_attrs=None):
    """
    Function to plot lattice grid.

    Parameters:
    -----------
    types: The site types at the lattice points as a list,
           list of strings.

    possible_types: A list of possible types, list of strings.

    markers: A list of marker parameter for corresponding basis_site.

    color_dict: circle color for different types.
                e.g. {type: color_code}, dict.

    time: time for the configure, float.

    circle_attrs: same as **kwargs in plt.patch()
                  (http://matplotlib.org/api/patches_api.html), dict.
    """
    # Check consistency of color_dict and types.
    consistent = np.array([t in color_dict for t in possible_types]).all()
    if not consistent:
        raise ValueError('All possible type should be in color_dict.')

    # Set containers.
    fig = plt.figure()
    ax = fig.add_subplot(111)
    ax.set_aspect('equal', adjustable='box')

    # Get scatter attrs
    alpha = circle_attrs['alpha'] if 'alpha' in circle_attrs else 0.7
    if "area" not in circle_attrs:
        area = 60.0**2/len(types)*20
    else:
        area = circle_attrs[area]

    # Classify points.
    scatter_dict = {}  # {adsorbate string: list of points}
    for t in possible_types:
        scatter_dict.setdefault(t, [])

    for idx, (t, coord) in enumerate(zip(types, coordinates)):  # t, pt <-> type, scatter_pt
        x, y = coord[: 2]
        color = color_dict[t]
        marker_idx = idx % len(markers)
        marker = markers[marker_idx]
        edgecolor = color
        ax.scatter(x, y, s=area, c=color, alpha=alpha, edgecolor=edgecolor, marker=marker)

    # Set axes attrs.
    ax.set_xlim(-0.1, shape[0] + 0.1)
    ax.set_ylim(-0.1, shape[-1] + 0.1)
    ax.set_xticks([])
    ax.set_yticks([])

    # Attrs of axis.
    for spine in ax.spines.values():
        spine.set_linestyle('dashed')
        spine.set_alpha(0.5)
        spine.set_color('#AAAAAA')

    # Get proper time format
    if time < 1e-2:
        time = '%es' % time
    else:
        time = '%dh %dmin %.2fsec' % convert_time(time)
    ax.set_title('Step = %d  ( %s )' % (step, time))
    ax.grid(True)

    return fig

if __name__ == '__main__':

    shape = (10, 10)
    sites=[[       0.000000,       0.000000,       0.000000],
       [       0.500000,       0.000000,       0.000000],
       [       0.000000,       0.500000,       0.000000],
       [       0.500000,       0.500000,       0.000000],
       [       0.000000,       1.000000,       0.000000],
       [       0.500000,       1.000000,       0.000000],
       [       0.000000,       1.500000,       0.000000],
       [       0.500000,       1.500000,       0.000000],
       [       0.000000,       2.000000,       0.000000],
       [       0.500000,       2.000000,       0.000000],
       [       0.000000,       2.500000,       0.000000],
       [       0.500000,       2.500000,       0.000000],
       [       0.000000,       3.000000,       0.000000],
       [       0.500000,       3.000000,       0.000000],
       [       0.000000,       3.500000,       0.000000],
       [       0.500000,       3.500000,       0.000000],
       [       0.000000,       4.000000,       0.000000],
       [       0.500000,       4.000000,       0.000000],
       [       0.000000,       4.500000,       0.000000],
       [       0.500000,       4.500000,       0.000000],
       [       0.000000,       5.000000,       0.000000],
       [       0.500000,       5.000000,       0.000000],
       [       0.000000,       5.500000,       0.000000],
       [       0.500000,       5.500000,       0.000000],
       [       0.000000,       6.000000,       0.000000],
       [       0.500000,       6.000000,       0.000000],
       [       0.000000,       6.500000,       0.000000],
       [       0.500000,       6.500000,       0.000000],
       [       0.000000,       7.000000,       0.000000],
       [       0.500000,       7.000000,       0.000000],
       [       0.000000,       7.500000,       0.000000],
       [       0.500000,       7.500000,       0.000000],
       [       0.000000,       8.000000,       0.000000],
       [       0.500000,       8.000000,       0.000000],
       [       0.000000,       8.500000,       0.000000],
       [       0.500000,       8.500000,       0.000000],
       [       0.000000,       9.000000,       0.000000],
       [       0.500000,       9.000000,       0.000000],
       [       0.000000,       9.500000,       0.000000],
       [       0.500000,       9.500000,       0.000000],
       [       1.000000,       0.000000,       0.000000],
       [       1.500000,       0.000000,       0.000000],
       [       1.000000,       0.500000,       0.000000],
       [       1.500000,       0.500000,       0.000000],
       [       1.000000,       1.000000,       0.000000],
       [       1.500000,       1.000000,       0.000000],
       [       1.000000,       1.500000,       0.000000],
       [       1.500000,       1.500000,       0.000000],
       [       1.000000,       2.000000,       0.000000],
       [       1.500000,       2.000000,       0.000000],
       [       1.000000,       2.500000,       0.000000],
       [       1.500000,       2.500000,       0.000000],
       [       1.000000,       3.000000,       0.000000],
       [       1.500000,       3.000000,       0.000000],
       [       1.000000,       3.500000,       0.000000],
       [       1.500000,       3.500000,       0.000000],
       [       1.000000,       4.000000,       0.000000],
       [       1.500000,       4.000000,       0.000000],
       [       1.000000,       4.500000,       0.000000],
       [       1.500000,       4.500000,       0.000000],
       [       1.000000,       5.000000,       0.000000],
       [       1.500000,       5.000000,       0.000000],
       [       1.000000,       5.500000,       0.000000],
       [       1.500000,       5.500000,       0.000000],
       [       1.000000,       6.000000,       0.000000],
       [       1.500000,       6.000000,       0.000000],
       [       1.000000,       6.500000,       0.000000],
       [       1.500000,       6.500000,       0.000000],
       [       1.000000,       7.000000,       0.000000],
       [       1.500000,       7.000000,       0.000000],
       [       1.000000,       7.500000,       0.000000],
       [       1.500000,       7.500000,       0.000000],
       [       1.000000,       8.000000,       0.000000],
       [       1.500000,       8.000000,       0.000000],
       [       1.000000,       8.500000,       0.000000],
       [       1.500000,       8.500000,       0.000000],
       [       1.000000,       9.000000,       0.000000],
       [       1.500000,       9.000000,       0.000000],
       [       1.000000,       9.500000,       0.000000],
       [       1.500000,       9.500000,       0.000000],
       [       2.000000,       0.000000,       0.000000],
       [       2.500000,       0.000000,       0.000000],
       [       2.000000,       0.500000,       0.000000],
       [       2.500000,       0.500000,       0.000000],
       [       2.000000,       1.000000,       0.000000],
       [       2.500000,       1.000000,       0.000000],
       [       2.000000,       1.500000,       0.000000],
       [       2.500000,       1.500000,       0.000000],
       [       2.000000,       2.000000,       0.000000],
       [       2.500000,       2.000000,       0.000000],
       [       2.000000,       2.500000,       0.000000],
       [       2.500000,       2.500000,       0.000000],
       [       2.000000,       3.000000,       0.000000],
       [       2.500000,       3.000000,       0.000000],
       [       2.000000,       3.500000,       0.000000],
       [       2.500000,       3.500000,       0.000000],
       [       2.000000,       4.000000,       0.000000],
       [       2.500000,       4.000000,       0.000000],
       [       2.000000,       4.500000,       0.000000],
       [       2.500000,       4.500000,       0.000000],
       [       2.000000,       5.000000,       0.000000],
       [       2.500000,       5.000000,       0.000000],
       [       2.000000,       5.500000,       0.000000],
       [       2.500000,       5.500000,       0.000000],
       [       2.000000,       6.000000,       0.000000],
       [       2.500000,       6.000000,       0.000000],
       [       2.000000,       6.500000,       0.000000],
       [       2.500000,       6.500000,       0.000000],
       [       2.000000,       7.000000,       0.000000],
       [       2.500000,       7.000000,       0.000000],
       [       2.000000,       7.500000,       0.000000],
       [       2.500000,       7.500000,       0.000000],
       [       2.000000,       8.000000,       0.000000],
       [       2.500000,       8.000000,       0.000000],
       [       2.000000,       8.500000,       0.000000],
       [       2.500000,       8.500000,       0.000000],
       [       2.000000,       9.000000,       0.000000],
       [       2.500000,       9.000000,       0.000000],
       [       2.000000,       9.500000,       0.000000],
       [       2.500000,       9.500000,       0.000000],
       [       3.000000,       0.000000,       0.000000],
       [       3.500000,       0.000000,       0.000000],
       [       3.000000,       0.500000,       0.000000],
       [       3.500000,       0.500000,       0.000000],
       [       3.000000,       1.000000,       0.000000],
       [       3.500000,       1.000000,       0.000000],
       [       3.000000,       1.500000,       0.000000],
       [       3.500000,       1.500000,       0.000000],
       [       3.000000,       2.000000,       0.000000],
       [       3.500000,       2.000000,       0.000000],
       [       3.000000,       2.500000,       0.000000],
       [       3.500000,       2.500000,       0.000000],
       [       3.000000,       3.000000,       0.000000],
       [       3.500000,       3.000000,       0.000000],
       [       3.000000,       3.500000,       0.000000],
       [       3.500000,       3.500000,       0.000000],
       [       3.000000,       4.000000,       0.000000],
       [       3.500000,       4.000000,       0.000000],
       [       3.000000,       4.500000,       0.000000],
       [       3.500000,       4.500000,       0.000000],
       [       3.000000,       5.000000,       0.000000],
       [       3.500000,       5.000000,       0.000000],
       [       3.000000,       5.500000,       0.000000],
       [       3.500000,       5.500000,       0.000000],
       [       3.000000,       6.000000,       0.000000],
       [       3.500000,       6.000000,       0.000000],
       [       3.000000,       6.500000,       0.000000],
       [       3.500000,       6.500000,       0.000000],
       [       3.000000,       7.000000,       0.000000],
       [       3.500000,       7.000000,       0.000000],
       [       3.000000,       7.500000,       0.000000],
       [       3.500000,       7.500000,       0.000000],
       [       3.000000,       8.000000,       0.000000],
       [       3.500000,       8.000000,       0.000000],
       [       3.000000,       8.500000,       0.000000],
       [       3.500000,       8.500000,       0.000000],
       [       3.000000,       9.000000,       0.000000],
       [       3.500000,       9.000000,       0.000000],
       [       3.000000,       9.500000,       0.000000],
       [       3.500000,       9.500000,       0.000000],
       [       4.000000,       0.000000,       0.000000],
       [       4.500000,       0.000000,       0.000000],
       [       4.000000,       0.500000,       0.000000],
       [       4.500000,       0.500000,       0.000000],
       [       4.000000,       1.000000,       0.000000],
       [       4.500000,       1.000000,       0.000000],
       [       4.000000,       1.500000,       0.000000],
       [       4.500000,       1.500000,       0.000000],
       [       4.000000,       2.000000,       0.000000],
       [       4.500000,       2.000000,       0.000000],
       [       4.000000,       2.500000,       0.000000],
       [       4.500000,       2.500000,       0.000000],
       [       4.000000,       3.000000,       0.000000],
       [       4.500000,       3.000000,       0.000000],
       [       4.000000,       3.500000,       0.000000],
       [       4.500000,       3.500000,       0.000000],
       [       4.000000,       4.000000,       0.000000],
       [       4.500000,       4.000000,       0.000000],
       [       4.000000,       4.500000,       0.000000],
       [       4.500000,       4.500000,       0.000000],
       [       4.000000,       5.000000,       0.000000],
       [       4.500000,       5.000000,       0.000000],
       [       4.000000,       5.500000,       0.000000],
       [       4.500000,       5.500000,       0.000000],
       [       4.000000,       6.000000,       0.000000],
       [       4.500000,       6.000000,       0.000000],
       [       4.000000,       6.500000,       0.000000],
       [       4.500000,       6.500000,       0.000000],
       [       4.000000,       7.000000,       0.000000],
       [       4.500000,       7.000000,       0.000000],
       [       4.000000,       7.500000,       0.000000],
       [       4.500000,       7.500000,       0.000000],
       [       4.000000,       8.000000,       0.000000],
       [       4.500000,       8.000000,       0.000000],
       [       4.000000,       8.500000,       0.000000],
       [       4.500000,       8.500000,       0.000000],
       [       4.000000,       9.000000,       0.000000],
       [       4.500000,       9.000000,       0.000000],
       [       4.000000,       9.500000,       0.000000],
       [       4.500000,       9.500000,       0.000000],
       [       5.000000,       0.000000,       0.000000],
       [       5.500000,       0.000000,       0.000000],
       [       5.000000,       0.500000,       0.000000],
       [       5.500000,       0.500000,       0.000000],
       [       5.000000,       1.000000,       0.000000],
       [       5.500000,       1.000000,       0.000000],
       [       5.000000,       1.500000,       0.000000],
       [       5.500000,       1.500000,       0.000000],
       [       5.000000,       2.000000,       0.000000],
       [       5.500000,       2.000000,       0.000000],
       [       5.000000,       2.500000,       0.000000],
       [       5.500000,       2.500000,       0.000000],
       [       5.000000,       3.000000,       0.000000],
       [       5.500000,       3.000000,       0.000000],
       [       5.000000,       3.500000,       0.000000],
       [       5.500000,       3.500000,       0.000000],
       [       5.000000,       4.000000,       0.000000],
       [       5.500000,       4.000000,       0.000000],
       [       5.000000,       4.500000,       0.000000],
       [       5.500000,       4.500000,       0.000000],
       [       5.000000,       5.000000,       0.000000],
       [       5.500000,       5.000000,       0.000000],
       [       5.000000,       5.500000,       0.000000],
       [       5.500000,       5.500000,       0.000000],
       [       5.000000,       6.000000,       0.000000],
       [       5.500000,       6.000000,       0.000000],
       [       5.000000,       6.500000,       0.000000],
       [       5.500000,       6.500000,       0.000000],
       [       5.000000,       7.000000,       0.000000],
       [       5.500000,       7.000000,       0.000000],
       [       5.000000,       7.500000,       0.000000],
       [       5.500000,       7.500000,       0.000000],
       [       5.000000,       8.000000,       0.000000],
       [       5.500000,       8.000000,       0.000000],
       [       5.000000,       8.500000,       0.000000],
       [       5.500000,       8.500000,       0.000000],
       [       5.000000,       9.000000,       0.000000],
       [       5.500000,       9.000000,       0.000000],
       [       5.000000,       9.500000,       0.000000],
       [       5.500000,       9.500000,       0.000000],
       [       6.000000,       0.000000,       0.000000],
       [       6.500000,       0.000000,       0.000000],
       [       6.000000,       0.500000,       0.000000],
       [       6.500000,       0.500000,       0.000000],
       [       6.000000,       1.000000,       0.000000],
       [       6.500000,       1.000000,       0.000000],
       [       6.000000,       1.500000,       0.000000],
       [       6.500000,       1.500000,       0.000000],
       [       6.000000,       2.000000,       0.000000],
       [       6.500000,       2.000000,       0.000000],
       [       6.000000,       2.500000,       0.000000],
       [       6.500000,       2.500000,       0.000000],
       [       6.000000,       3.000000,       0.000000],
       [       6.500000,       3.000000,       0.000000],
       [       6.000000,       3.500000,       0.000000],
       [       6.500000,       3.500000,       0.000000],
       [       6.000000,       4.000000,       0.000000],
       [       6.500000,       4.000000,       0.000000],
       [       6.000000,       4.500000,       0.000000],
       [       6.500000,       4.500000,       0.000000],
       [       6.000000,       5.000000,       0.000000],
       [       6.500000,       5.000000,       0.000000],
       [       6.000000,       5.500000,       0.000000],
       [       6.500000,       5.500000,       0.000000],
       [       6.000000,       6.000000,       0.000000],
       [       6.500000,       6.000000,       0.000000],
       [       6.000000,       6.500000,       0.000000],
       [       6.500000,       6.500000,       0.000000],
       [       6.000000,       7.000000,       0.000000],
       [       6.500000,       7.000000,       0.000000],
       [       6.000000,       7.500000,       0.000000],
       [       6.500000,       7.500000,       0.000000],
       [       6.000000,       8.000000,       0.000000],
       [       6.500000,       8.000000,       0.000000],
       [       6.000000,       8.500000,       0.000000],
       [       6.500000,       8.500000,       0.000000],
       [       6.000000,       9.000000,       0.000000],
       [       6.500000,       9.000000,       0.000000],
       [       6.000000,       9.500000,       0.000000],
       [       6.500000,       9.500000,       0.000000],
       [       7.000000,       0.000000,       0.000000],
       [       7.500000,       0.000000,       0.000000],
       [       7.000000,       0.500000,       0.000000],
       [       7.500000,       0.500000,       0.000000],
       [       7.000000,       1.000000,       0.000000],
       [       7.500000,       1.000000,       0.000000],
       [       7.000000,       1.500000,       0.000000],
       [       7.500000,       1.500000,       0.000000],
       [       7.000000,       2.000000,       0.000000],
       [       7.500000,       2.000000,       0.000000],
       [       7.000000,       2.500000,       0.000000],
       [       7.500000,       2.500000,       0.000000],
       [       7.000000,       3.000000,       0.000000],
       [       7.500000,       3.000000,       0.000000],
       [       7.000000,       3.500000,       0.000000],
       [       7.500000,       3.500000,       0.000000],
       [       7.000000,       4.000000,       0.000000],
       [       7.500000,       4.000000,       0.000000],
       [       7.000000,       4.500000,       0.000000],
       [       7.500000,       4.500000,       0.000000],
       [       7.000000,       5.000000,       0.000000],
       [       7.500000,       5.000000,       0.000000],
       [       7.000000,       5.500000,       0.000000],
       [       7.500000,       5.500000,       0.000000],
       [       7.000000,       6.000000,       0.000000],
       [       7.500000,       6.000000,       0.000000],
       [       7.000000,       6.500000,       0.000000],
       [       7.500000,       6.500000,       0.000000],
       [       7.000000,       7.000000,       0.000000],
       [       7.500000,       7.000000,       0.000000],
       [       7.000000,       7.500000,       0.000000],
       [       7.500000,       7.500000,       0.000000],
       [       7.000000,       8.000000,       0.000000],
       [       7.500000,       8.000000,       0.000000],
       [       7.000000,       8.500000,       0.000000],
       [       7.500000,       8.500000,       0.000000],
       [       7.000000,       9.000000,       0.000000],
       [       7.500000,       9.000000,       0.000000],
       [       7.000000,       9.500000,       0.000000],
       [       7.500000,       9.500000,       0.000000],
       [       8.000000,       0.000000,       0.000000],
       [       8.500000,       0.000000,       0.000000],
       [       8.000000,       0.500000,       0.000000],
       [       8.500000,       0.500000,       0.000000],
       [       8.000000,       1.000000,       0.000000],
       [       8.500000,       1.000000,       0.000000],
       [       8.000000,       1.500000,       0.000000],
       [       8.500000,       1.500000,       0.000000],
       [       8.000000,       2.000000,       0.000000],
       [       8.500000,       2.000000,       0.000000],
       [       8.000000,       2.500000,       0.000000],
       [       8.500000,       2.500000,       0.000000],
       [       8.000000,       3.000000,       0.000000],
       [       8.500000,       3.000000,       0.000000],
       [       8.000000,       3.500000,       0.000000],
       [       8.500000,       3.500000,       0.000000],
       [       8.000000,       4.000000,       0.000000],
       [       8.500000,       4.000000,       0.000000],
       [       8.000000,       4.500000,       0.000000],
       [       8.500000,       4.500000,       0.000000],
       [       8.000000,       5.000000,       0.000000],
       [       8.500000,       5.000000,       0.000000],
       [       8.000000,       5.500000,       0.000000],
       [       8.500000,       5.500000,       0.000000],
       [       8.000000,       6.000000,       0.000000],
       [       8.500000,       6.000000,       0.000000],
       [       8.000000,       6.500000,       0.000000],
       [       8.500000,       6.500000,       0.000000],
       [       8.000000,       7.000000,       0.000000],
       [       8.500000,       7.000000,       0.000000],
       [       8.000000,       7.500000,       0.000000],
       [       8.500000,       7.500000,       0.000000],
       [       8.000000,       8.000000,       0.000000],
       [       8.500000,       8.000000,       0.000000],
       [       8.000000,       8.500000,       0.000000],
       [       8.500000,       8.500000,       0.000000],
       [       8.000000,       9.000000,       0.000000],
       [       8.500000,       9.000000,       0.000000],
       [       8.000000,       9.500000,       0.000000],
       [       8.500000,       9.500000,       0.000000],
       [       9.000000,       0.000000,       0.000000],
       [       9.500000,       0.000000,       0.000000],
       [       9.000000,       0.500000,       0.000000],
       [       9.500000,       0.500000,       0.000000],
       [       9.000000,       1.000000,       0.000000],
       [       9.500000,       1.000000,       0.000000],
       [       9.000000,       1.500000,       0.000000],
       [       9.500000,       1.500000,       0.000000],
       [       9.000000,       2.000000,       0.000000],
       [       9.500000,       2.000000,       0.000000],
       [       9.000000,       2.500000,       0.000000],
       [       9.500000,       2.500000,       0.000000],
       [       9.000000,       3.000000,       0.000000],
       [       9.500000,       3.000000,       0.000000],
       [       9.000000,       3.500000,       0.000000],
       [       9.500000,       3.500000,       0.000000],
       [       9.000000,       4.000000,       0.000000],
       [       9.500000,       4.000000,       0.000000],
       [       9.000000,       4.500000,       0.000000],
       [       9.500000,       4.500000,       0.000000],
       [       9.000000,       5.000000,       0.000000],
       [       9.500000,       5.000000,       0.000000],
       [       9.000000,       5.500000,       0.000000],
       [       9.500000,       5.500000,       0.000000],
       [       9.000000,       6.000000,       0.000000],
       [       9.500000,       6.000000,       0.000000],
       [       9.000000,       6.500000,       0.000000],
       [       9.500000,       6.500000,       0.000000],
       [       9.000000,       7.000000,       0.000000],
       [       9.500000,       7.000000,       0.000000],
       [       9.000000,       7.500000,       0.000000],
       [       9.500000,       7.500000,       0.000000],
       [       9.000000,       8.000000,       0.000000],
       [       9.500000,       8.000000,       0.000000],
       [       9.000000,       8.500000,       0.000000],
       [       9.500000,       8.500000,       0.000000],
       [       9.000000,       9.000000,       0.000000],
       [       9.500000,       9.000000,       0.000000],
       [       9.000000,       9.500000,       0.000000],
       [       9.500000,       9.500000,       0.000000]]

    types = ["V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V",
              "V","V","V","V","V","V","V","V","V","V","V","O_s","V","V","V","O_s","V","V",
              "V","V","V","V","O_s","V","V","V","V","V","V","V","V","O_s","V","V","V","O_s",
              "V","V","V","V","V","V","V","V","V","V","O_s","V","V","V","V","V","V","V",
              "V","O_s","V","V","V","O_s","V","V","O_s","V","V","V","V","V","V","V","V",
              "V","V","V","V","V","V","V","V","V","V","V","O_s","V","V","V","O_s","V","V",
              "V","V","V","V","V","V","O_s","V","V","V","O_s","V","V","O_s","V","V","V",
              "V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","O_s","V",
              "V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","O_s",
              "V","V","V","O_s","V","V","V","V","V","V","V","V","V","V","V","O_s","V","V",
              "V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V",
              "V","V","V","O_s","V","V","O_s","O_s","V","V","V","O_s","V","V","V","O_s",
              "V","V","O_s","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V",
              "V","V","V","V","V","V","V","V","V","V","V","V","O_s","V","V","V","V","V",
              "V","V","V","V","V","V","V","V","V","V","V","O_s","V","V","O_s","O_s","V",
              "V","V","V","V","V","O_s","V","V","V","V","V","V","V","V","V","V","V","O_s",
              "V","V","V","V","V","V","V","V","V","V","V","V","O_s","V","V","V","O_s","V",
              "V","O_s","V","V","V","V","V","V","V","O_s","V","V","V","V","V","V","V","V",
              "V","V","V","O_s","V","V","V","V","V","V","V","O_s","V","V","V","V","V","V",
              "V","V","O_s","V","V","V","O_s","V","V","V","V","V","V","V","V","V","V","V",
              "V","V","V","V","V","V","V","O_s","V","V","V","V","V","V","V","O_s","V","V",
              "V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V","V",
              "V","V","V","V","V"]

    possible_types = ('V', 'O', 'O_s', 'C')

    markers = ('o', 'V', 'V', 's')

    color_dict = dict(
        V='#FFFFFF',
        O_s='#FF6347',
        O='#EE0000',
        C='#607B8B',
        )
    circle_attrs = dict(
        alpha=0.7,
        antialiased=True,
        edgecolor='#FFFFFF',
        )

    fig = plot_scatters(types, shape, sites, markers, possible_types, color_dict,
                        time=0.01, step=2, circle_attrs=circle_attrs)

    plt.show()
